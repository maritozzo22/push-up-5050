# Phase 03.5: Smart Notifications - Context

**Gathered:** 2026-01-26
**Status:** Ready for planning

## Phase Boundary

Contextual push notifications that keep users engaged without spamming. System sends notifications at personalized times based on user workout patterns. Types include: streak-at-risk warnings, progress encouragements, and new challenge announcements.

**NOT in scope:** General notification infrastructure (exists), in-app alerts (exist), achievement popups (exist).

---

## Implementation Decisions

### Streak at Risk Timing

- **Trigger:** Morning of day 3 (after 2 consecutive days with zero push-ups)
- **Missed day definition:** Day with 0 total push-ups (any activity preserves streak)
- **Suppression rule:** If user has done ≥1 push-up today, don't send streak warning (they're active)
- **Escalation:** Day 3 = motivational reminder. Day 4+ = "Last chance!" with streak count reminder
- **No limit:** Keep sending daily escalating notifications until streak breaks or user works out

### Progress Notification Behavior

- **Smart threshold:** Only fire when user is within 5 of daily goal AND has completed ≥50% of goal
- **Timing:** Send at personalized workout time, only if conditions are met at that moment
- **No premature celebration:** If user reaches goal without triggering notification, no separate "goal complete" message
- **Streak celebration:** Notify when goal is achieved ONLY if it extends a streak (e.g., "Day 7 complete!")
- **One-time:** Progress notification fires once per day at most

### Personalization Logic

- **Time slot calculation:** Find the 2-hour window where user most frequently completes workouts
- **Fallback time:** 9:00 AM for new users or before sufficient data
- **Minimum data:** Require 7 workout days before switching from fallback to personalized time
- **Re-calculation:** Update personalized time weekly based on new workout patterns
- **Sunday challenge:** Always fires at 8:00 AM (not personalized) — new weekly challenge announcement

### Notification Content & Tone

- **Streak Day 3 tone:** Motivational — "You've built something great — keep it going with just 5 push-ups!"
- **Streak Day 4+ tone:** Escalation with streak count — "XX days on the line — don't let it disappear!"
- **Progress tone:** Encouraging with specific count — "Almost there! Just 5 more push-ups to reach your daily goal."
- **Rotating messages:** 3-5 variations per notification type to avoid fatigue
- **Localization:** All messages must be localized (IT/EN like rest of app)

### Claude's Discretion

- Exact wording of message variations
- Whether to include emoji in notifications
- Deep link behavior when notification is tapped (which screen to open)
- Notification channel/category grouping in Android settings

---

## Specific Ideas

- User mentioned: "Don't send streak warning if they're doing at least 1 rep per day"
- User suggested: "We should think about other notification types like weekly challenge reminders (if not completed)" — **deferred to future phase**

---

## Deferred Ideas

- Weekly challenge reminder notification (if user hasn't completed by Saturday) — new capability, future phase
- "Good streak" milestone notifications (e.g., "10-day streak!") — nice-to-have, future phase
- Workout summary notifications (end of day stats) — new capability, future phase

---

*Phase: 03.5-smart-notifications*
*Context gathered: 2026-01-26*
