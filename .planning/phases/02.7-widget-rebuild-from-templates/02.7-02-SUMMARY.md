---
phase: 02.7-widget-rebuild-from-templates
plan: 02
subsystem: ui
tags: android, widget, xml-layout, widget-info

# Dependency graph
requires:
  - phase: 02.7-01
    provides: widget drawable resources (colors, backgrounds, buttons, day chips)
provides:
  - 4x4 widget layout matching template structure with 4 vertical sections
  - 2x1 widget layout with centered stats and 3-day view
  - Correct widget size registration (4x4 and 2x1)
affects: [02.7-03, providers, AndroidManifest.xml]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - FrameLayout root with nested LinearLayout for vertical stacking
    - View ID preservation for provider compatibility
    - Centralized color references from widget_colors.xml

key-files:
  created:
    - push_up_5050/android/app/src/main/res/layout/pushup_widget_4x4.xml
    - push_up_5050/android/app/src/main/res/layout/pushup_widget_2x1.xml
    - push_up_5050/android/app/src/main/res/xml/pushup_widget_4x4_info.xml
  modified:
    - push_up_5050/android/app/src/main/res/xml/pushup_widget_small_info.xml

key-decisions:
  - "4x4 widget layout uses FrameLayout root with LinearLayout for 4-section vertical structure"
  - "2x1 widget layout uses 3-line total display format matching template (44 / 5050)"
  - "View IDs preserved from existing providers for compatibility: today_count, total_count, start_button_container, day_1-7, day_yesterday_*, day_today_*, day_tomorrow_*"
  - "resizeMode=none for both widgets (fixed size, templates are fixed aspect)"

patterns-established:
  - "View ID preservation: New layouts use same IDs as old layouts for provider compatibility"
  - "Centralized colors: All layouts reference @color/widget_* values from widget_colors.xml"
  - "Template replication: Layout structure matches Flutter templates exactly (proportions, spacing, hierarchy)"

# Metrics
duration: 6min
completed: 2026-01-22
---

# Phase 2.7 Plan 02: Widget Layouts Summary

**4x4 and 2x1 Android widget layouts matching exact template structure with correct size registration**

## Performance

- **Duration:** 6 min
- **Started:** 2026-01-22T18:52:38Z
- **Completed:** 2026-01-22T18:58:56Z
- **Tasks:** 3
- **Files modified:** 4

## Accomplishments

- Created 4x4 widget layout with 4 vertical sections (top panel, stats, START button, 7-day row)
- Created 2x1 widget layout with centered stats and 3-day calendar view
- Fixed 4x4 widget size registration bug (was 2x2, now correctly 4x4)
- Preserved all view IDs for existing provider compatibility

## Task Commits

Each task was committed atomically:

1. **Task 1: Create 4x4 widget layout matching template structure** - `24991c8` (feat)
2. **Task 2: Create 2x1 widget layout with centered stats and 3-day view** - `bb77f98` (feat)
3. **Task 3: Create widget info files with correct sizes** - `5d3971a` (feat)

**Plan metadata:** TBD (docs: complete plan)

## Files Created/Modified

- `push_up_5050/android/app/src/main/res/layout/pushup_widget_4x4.xml` - 4x4 widget layout with top stats panel, circular START button, 7-day row (L M M G V S D)
- `push_up_5050/android/app/src/main/res/layout/pushup_widget_2x1.xml` - 2x1 widget layout with centered OGGI/TOTALE stats and 3-day view (Ieri-Oggi-Domani)
- `push_up_5050/android/app/src/main/res/xml/pushup_widget_4x4_info.xml` - 4x4 widget size registration (targetCellWidth=4 targetCellHeight=4)
- `push_up_5050/android/app/src/main/res/xml/pushup_widget_small_info.xml` - 2x1 widget info updated to point to new layout

## Decisions Made

- **4x4 layout structure:** Used FrameLayout root with LinearLayout vertical container to match template's 4-section stack (top panel, stats, START button, 7-day row)
- **2x1 3-line total format:** Total displayed as 3 separate TextViews (value / slash / goal) matching template's "44 / 5050" visual
- **View ID preservation:** All IDs from existing layouts preserved (today_count, total_count, start_button_container, day_1-7) so providers work without code changes
- **resizeMode=none:** Both widgets use fixed size (no resizing) because templates are designed for specific aspect ratios

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None - all drawable resources from plan 01 were available, layout creation proceeded smoothly.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

- Layouts ready for provider integration (Plan 03)
- View IDs match existing provider expectations
- Size registration correct - widgets will appear at proper sizes in picker
- Need to update AndroidManifest.xml to register new widget info files
- Need to verify 2x1 layout IDs with PushupWidgetSmallProvider (added total_count_3line TextViews that provider doesn't use)

---
*Phase: 02.7-widget-rebuild-from-templates*
*Completed: 2026-01-22*
