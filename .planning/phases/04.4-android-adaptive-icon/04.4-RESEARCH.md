# Phase 04.4: Android Adaptive Icon - Research

**Researched:** 2026-01-30
**Domain:** Android Adaptive Icons / flutter_launcher_icons
**Confidence:** HIGH

## Summary

Android Adaptive Icons are the standard launcher icon format introduced in Android 8.0 (API level 26). They consist of two layers (foreground + background) that allow launchers to apply various mask shapes (circle, squircle, teardrop, square) while maintaining visual consistency. Android 13+ added support for themed icons via a monochrome layer.

The project already has `flutter_launcher_icons` v0.13.1 configured but NOT generating adaptive icons - the `mipmap-anydpi-v26/` directory exists but is empty, and the current `pubspec.yaml` references an outdated background color (`#000000`) and reuses the same icon for foreground. The phase requires updating configuration to use brand orange (`#FF6B00`) and creating proper foreground/background layers.

**Primary recommendation:** Use `flutter_launcher_icons` package with adaptive icon configuration, then manually verify on Android emulator using launcher mock feature.

## Standard Stack

### Core
| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| flutter_launcher_icons | ^0.13.1 (already installed) | Generate launcher icons for all densities | Flutter community standard, maintained, supports adaptive icons |
| Android Adaptive Icons | API 26+ | Runtime adaptive icon system | Android native standard since Android 8.0 |

### Supporting
| Tool | Version | Purpose | When to Use |
|------|---------|---------|-------------|
| Android Studio Image Asset Studio | Built-in | Manual icon generation | When automated tools insufficient or custom shapes needed |
| Android Emulator Launcher Mock | Latest | Testing launcher shapes | Primary testing method - no physical devices needed |

### Alternatives Considered
| Instead of | Could Use | Tradeoff |
|------------|-----------|----------|
| flutter_launcher_icons | Manual Android Studio Image Asset Studio | Automated vs manual - flutter_launcher_icons is faster and sufficient for this use case |
| flutter_launcher_icons | flutter_app_icon | flutter_launcher_icons has better adaptive icon support and is more widely used |

**Installation:**
```bash
# Already installed - no new packages needed
flutter_launcher_icons: ^0.13.1  # in dev_dependencies
```

## Architecture Patterns

### Recommended Project Structure

```
push_up_5050/
├── assets/
│   └── launcher/
│       ├── icon.png              # 512x512 source for legacy icons (already exists)
│       ├── icon.svg              # Vector source (already exists)
│       ├── icon_foreground.png   # NEW: 108x108dp safe zone (logo only)
│       └── icon_background.png   # NEW: 108x108dp (orange gradient, optional - can use solid color)
├── android/app/src/main/res/
│   ├── mipmap-anydpi-v26/        # NEW: Adaptive icon XML (currently empty)
│   │   ├── ic_launcher.xml
│   │   └── ic_launcher_round.xml
│   ├── drawable-*/               # NEW: Foreground/background layers for v26+
│   │   ├── ic_launcher_foreground.xml  # Vector drawable or PNG reference
│   │   └── ic_launcher_background.xml  # Color or drawable reference
│   └── mipmap-*/                 # Legacy icons (already exist, will be regenerated)
│       ├── mdpi/
│       ├── hdpi/
│       ├── xhdpi/
│       ├── xxhdpi/
│       └── xxxhdpi/
└── pubspec.yaml                  # Update flutter_launcher_icons config
```

### Pattern 1: flutter_launcher_icons Configuration

**What:** YAML-based configuration in `pubspec.yaml` that generates all required icon resources.

**When to use:** All Flutter projects - this is the standard approach.

**Example:**
```yaml
dev_dependencies:
  flutter_launcher_icons: ^0.13.1

flutter_launcher_icons:
  android: true
  ios: false  # Out of scope for this phase
  image_path: "assets/launcher/icon.png"  # Legacy fallback icon

  # Adaptive icon configuration (generates mipmap-anydpi-v26 resources)
  adaptive_icon_background: "#FF6B00"  # Brand orange - can be color OR image path
  adaptive_icon_foreground: "assets/launcher/icon_foreground.png"  # Logo layer only

  # Android 13+ themed icons (optional, recommended)
  # adaptive_icon_monochrome: "assets/launcher/icon_monochrome.png"

  min_sdk_android: 21
```

**Running the generator:**
```bash
flutter pub get
dart run flutter_launcher_icons
```

### Pattern 2: Adaptive Icon XML Structure (Generated)

**What:** The XML files generated in `mipmap-anydpi-v26/` that define adaptive layers.

**Source:** [Android Adaptive Icons Documentation](https://developer.android.com/develop/ui/views/launch/icon_design_adaptive)

**Example:**
```xml
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@drawable/ic_launcher_background"/>
    <foreground android:drawable="@drawable/ic_launcher_foreground"/>
    <!-- Optional for Android 13+ themed icons -->
    <monochrome android:drawable="@drawable/ic_launcher_monochrome"/>
</adaptive-icon>
```

### Pattern 3: Safe Zone Design

**What:** 108x108dp canvas with 66x66dp safe zone - foreground content must stay within safe zone.

**Source:** [Android Official Documentation](https://developer.android.com/develop/ui/views/launch/icon_design_adaptive)

**Dimensions:**
- Total canvas: 108x108 dp
- Safe zone (never clipped): 66x66 dp (center)
- Outer 18dp on each side reserved for visual effects/masking

**Keyline shapes for consistency:**
- Circle: 52dp and 36dp diameter
- Square: 44dp x 44dp, 4dp corner radius
- Rectangles: 52dp x 36dp and 36dp x 52dp, 4dp corner radius

### Anti-Patterns to Avoid

- **Using full icon as foreground:** Foreground should be logo/icon only, NOT the entire icon with background. The background layer fills separately.
- **Ignoring safe zone:** Foreground content extending beyond 66dp safe zone will be clipped on some launchers.
- **Using transparent background for legacy icons:** Android < 8.0 doesn't support adaptive icons - legacy icons must have opaque backgrounds.
- **Forgetting `android:roundIcon`:** Some launchers specifically request round icons - should reference adaptive icon.

## Don't Hand-Roll

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Icon density generation | Manual PNG creation for each density | flutter_launcher_icons | Generates 5+ densities (mdpi through xxxhdpi) automatically |
| Adaptive icon XML | Manual XML writing in mipmap-anydpi-v26/ | flutter_launcher_icons | Generates correct XML structure automatically |
| Icon sizing/resizing | Manual image editing | flutter_launcher_icons | Handles all dp-to-px calculations |

**Key insight:** Android adaptive icons require 5+ densities x 2 icons (regular + round) x 3 layers (foreground/background/legacy) = 30+ files. Automation prevents human error.

## Common Pitfalls

### Pitfall 1: Adaptive Icons Not Generating

**What goes wrong:** Running `dart run flutter_launcher_icons` but `mipmap-anydpi-v26/` remains empty or unchanged.

**Why it happens:** Adaptive icons only generate when BOTH `adaptive_icon_background` AND `adaptive_icon_foreground` are specified. The `image_path` is NOT automatically used as foreground.

**How to avoid:**
```yaml
# WRONG - won't generate adaptive icons
flutter_launcher_icons:
  android: true
  image_path: "assets/launcher/icon.png"

# CORRECT - will generate adaptive icons
flutter_launcher_icons:
  android: true
  image_path: "assets/launcher/icon.png"  # For legacy icons
  adaptive_icon_background: "#FF6B00"     # REQUIRED for adaptive
  adaptive_icon_foreground: "assets/launcher/icon_foreground.png"  # REQUIRED for adaptive
```

**Warning signs:** After running generator, `mipmap-anydpi-v26/ic_launcher.xml` doesn't exist or is unchanged.

### Pitfall 2: Foreground Image Wrong Size

**What goes wrong:** Icon looks clipped or poorly centered on some launchers.

**Why it happens:** Foreground image designed for full icon size (including background) rather than safe zone.

**How to avoid:** Create foreground asset with logo centered in 66x66dp safe zone. Use `adaptive_icon_foreground_inset` to add padding (default is 16%).

**Warning signs:** Logo appears too large or gets cut off on circular/squircle launchers.

### Pitfall 3: Legacy Icon Has Transparent Background

**What goes wrong:** Icon appears as black square on Android < 8.0 devices.

**Why it happens:** Older Android versions don't handle alpha channel in launcher icons properly.

**How to avoid:** Ensure `image_path` references an icon with opaque background. The existing `icon.png` should already have the dark gradient background from the SVG.

**Warning signs:** Testing on older Android device/emulator shows black square icon.

### Pitfall 4: Wrong Color Format

**What goes wrong:** `flutter_launcher_icons` fails with color parsing error.

**Why it happens:** Using incorrect hex color format (e.g., `#AABBGGRR` instead of `#AARRGGBB`).

**How to avoid:** Always use `#RRGGBB` or `#AARRGGBB` format (e.g., `#FF6B00`).

**Source:** [flutter_launcher_icons known issues](https://pub.dev/packages/flutter_launcher_icons)

## Code Examples

### Generating Adaptive Icons with flutter_launcher_icons

```yaml
# File: pubspec.yaml
dev_dependencies:
  flutter_launcher_icons: ^0.13.1

flutter_launcher_icons:
  android: true
  ios: false
  image_path: "assets/launcher/icon.png"

  # Adaptive icon configuration
  adaptive_icon_background: "#FF6B00"  # Brand orange as solid color
  # OR use image: adaptive_icon_background: "assets/launcher/icon_background.png"
  adaptive_icon_foreground: "assets/launcher/icon_foreground.png"

  # Optional: Add padding to foreground (default is 16%)
  # adaptive_icon_foreground_inset: 16

  # Optional: Android 13+ themed icons
  # adaptive_icon_monochrome: "assets/launcher/icon_monochrome.png"

  min_sdk_android: 21
```

```bash
# Run after updating configuration
cd push_up_5050
flutter pub get
dart run flutter_launcher_icons
```

### Testing on Android Emulator with Launcher Mock

```bash
# 1. Start emulator with launcher preview enabled
flutter emulators
flutter emulators --launch <emulator_id>

# 2. In Android Studio: Tools > Layout Inspector
# Or use adb command to trigger launcher preview
adb shell am broadcast -a com.android.launcher3.action.LAUNCHER_PREVIEW

# 3. Change launcher shape in emulator:
# Long press home screen > Wallpapers & style > Launcher icon
# Select different shapes to test
```

### Manual XML Verification (After Generation)

```xml
<!-- File: android/app/src/main/res/mipmap-anydpi-v26/ic_launcher.xml -->
<!-- This should be auto-generated - verify it looks like this -->
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@color/ic_launcher_background"/>
    <foreground android:drawable@mipmap/ic_launcher_foreground"/>
</adaptive-icon>
```

## State of the Art

| Old Approach | Current Approach | When Changed | Impact |
|--------------|------------------|--------------|--------|
| Static launcher icons only | Adaptive icons with foreground/background layers | Android 8.0 (API 26) - 2017 | Icons adapt to different launcher shapes |
| No theming support | Monochrome layer for Android 13+ themed icons | Android 13 (API 33) - 2022 | Icons inherit user's wallpaper/theme colors |
| Manual icon creation | flutter_launcher_icons automation | 2018+ | Standardized workflow for Flutter apps |

**Deprecated/outdated:**
- **Non-adaptive launcher icons:** Still supported for Android < 8.0 but shouldn't be the primary approach
- **Icon as single PNG:** No longer recommended - use foreground/background layers for Android 8.0+

## Android Density Specifications

| Density | Multiplier | Icon Size (px) | DP Equivalent |
|---------|------------|----------------|---------------|
| mdpi | 1x | 48x48 | 48dp |
| hdpi | 1.5x | 72x72 | 48dp |
| xhdpi | 2x | 96x96 | 48dp |
| xxhdpi | 3x | 144x144 | 48dp |
| xxxhdpi | 4x | 192x192 | 48dp |

**Adaptive icon layers:** 108x108dp base size
- Safe zone: 66x66dp (never clipped)
- Mask may reach minimum 33dp from center

**Source:** [Understanding Android App Icon Sizes](https://www.oreateai.com/blog/understanding-android-app-icon-sizes-a-comprehensive-guide/00dea18df93a7f1af0128ac2f99f49e6)

## Open Questions

### Q1: Monochrome Icon for Android 13+ Themed Icons

**What we know:** Android 13+ supports themed app icons via a monochrome layer. The `flutter_launcher_icons` package supports this via `adaptive_icon_monochrome` parameter.

**What's unclear:** Whether to include monochrome layer in this phase or defer. It's not explicitly required by the phase requirements.

**Recommendation:** Implement monochrome layer if time permits. It improves user experience on Android 13+ devices. The monochrome layer should be a grayscale version of the logo (push-up figure + 5050 text) without the orange glow/color.

### Q2: Gradient vs Solid Color Background

**What we know:** `adaptive_icon_background` can be either a hex color OR an image path. The CONTEXT.md specifies "orange gradient (subtle gradient using orange tones for depth)."

**What's unclear:** Whether to use solid `#FF6B00` or create a gradient background image.

**Recommendation:** Start with solid `#FF6B00` for simplicity. Test visual appearance - if gradient is needed, create a PNG with subtle gradient (e.g., top-to-bottom from `#FF8A33` to `#FF6B00`) and use `adaptive_icon_background: "assets/launcher/icon_background.png"`.

### Q3: Foreground Asset Creation

**What we know:** The existing `icon.svg` has a dark gradient background with orange ring, push-up figure, and 5050 text. The foreground layer should contain ONLY the logo elements (push-up figure + 5050 text + possibly ring) without the dark background.

**What's unclear:** Exact foreground composition - whether to include the orange ring in foreground or background.

**Recommendation:** Extract push-up figure + 5050 text as foreground. The orange ring could go either in foreground (as part of logo) or be implied by the orange background color. Test both approaches visually.

## Sources

### Primary (HIGH confidence)
- [Android Adaptive Icons Official Documentation](https://developer.android.com/develop/ui/views/launch/icon_design_adaptive) - Complete adaptive icon specification, including layers, safe zone, monochrome theming
- [flutter_launcher_icons on pub.dev](https://pub.dev/packages/flutter_launcher_icons) - Official package documentation with all configuration options
- [flutter_launcher_icons GitHub README](https://github.com/fluttercommunity/flutter_launcher_icons/blob/master/README.md) - Configuration reference and examples
- [Context7: /fluttercommunity/flutter_launcher_icons](https://pub.dev/documentation/flutter_launcher_icons/latest/android/createAdaptiveMonochromeIcons.html) - API documentation for monochrome icons

### Secondary (MEDIUM confidence)
- [Create adaptive icons in Flutter - LogRocket Blog](https://blog.logrocket.com/create-adaptive-icons-flutter-launcher-icons/) - Tutorial with examples of adaptive icon configuration
- [Supporting Themed App Icons for Android 13](https://blog.okaryo.studio/en/20221127-support-themed-app-icon-in-flutter-app-for-android-13/) - Guide for implementing Android 13+ themed icons
- [Understanding Android App Icon Sizes](https://www.oreateai.com/blog/understanding-android-app-icon-sizes-a-comprehensive-guide/00dea18df93a7f1af0128ac2f99f49e6) - Density specifications and sizing (January 2026)

### Tertiary (LOW confidence)
- [Android App Icon Generator - convertico](https://convertico.com/favicon-for-android/) - Online tool reference (not verified)
- [Android Adaptive Icons Figma Template](https://www.figma.com/community/file/1371452020151745140/android-adaptive-icons-template) - Design template (not verified)

## Metadata

**Confidence breakdown:**
- Standard stack: HIGH - flutter_launcher_icons is the de facto standard for Flutter
- Architecture: HIGH - Android adaptive icon spec is official and stable since 2017
- Pitfalls: HIGH - Common issues documented in package issues and Stack Overflow
- Density specifications: MEDIUM - Web sources vary slightly, but standard multipliers are consistent

**Research date:** 2026-01-30
**Valid until:** 2026-07-30 (6 months - Android adaptive icon spec is stable, package updates are infrequent)

**Current project state:**
- flutter_launcher_icons: ^0.13.1 (installed)
- mipmap-anydpi-v26/ directory exists but is EMPTY
- Current config uses `#000000` background (should be `#FF6B00`)
- Existing icon.svg has full design with dark background
- No foreground-only asset exists yet
