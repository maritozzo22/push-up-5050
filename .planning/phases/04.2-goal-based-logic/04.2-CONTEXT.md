# Phase 04.2: Goal-Based Logic - Context

**Gathered:** 2026-01-29
**Status:** Ready for planning

## Phase Boundary

Workout session behavior changes when daily goal is reached — automatic completion, prevention of new workouts, and midnight reset. The goal is to prevent users from continuing once their daily target is met, while handling edge cases like overshoot, app closure, and day transitions.

## Implementation Decisions

### Completion moment
- Workout completes AFTER finishing the current series, not mid-series
- Completion is based on CUMULATIVE reps from all today's workouts (not just current session)
- During final series: show existing series counter (no special "reps to goal" countdown)
- User knows workout completed via: Sound + visual transition

### Goal-overshoot handling
- Extra reps in final series: Cap stats at goal (bonus reps don't affect completion)
- Goal is 10, user is at series 4 (needs 4 reps): Finish all 4 reps of series 4, then workout ends
- No intentional overtraining: Stop at goal, no option to continue for bonus
- Undershoot scenario: User can manually end workout early, partial progress is saved

### Post-completion state
- After goal completion: Return to Home screen (not results screen)
- User can: View stats only (no workout-related actions)
- Start workout button: Disabled with 'Obiettivo completato' message
- Navigating to workout screen: Blocked — shows 'goal completed' message instead

### Midnight reset behavior
- Reset timing: Local midnight (00:00 in user's timezone)
- App closed at midnight: Reset applied when app opens after midnight
- Active workout at midnight: Continue with YESTERDAY'S goal until completed
- Grace period: None — midnight is hard cutoff

### Claude's Discretion
- Exact sound implementation for completion signal
- Visual design of 'goal completed' blocking message on workout screen
- UI state transitions for disabled start button

## Specific Ideas

- Finish the series before completing (e.g., goal 10: complete 1+2+3+4 series)
- All rep counts are cumulative across the day (multiple workout sessions)
- Home screen return after completion (not a separate results screen)

## Deferred Ideas

- Bonus workout mode after goal completion — mentioned as possibility but explicitly rejected ("No, stop at goal")
- "Continue for bonus" button — user wants strict stop at goal behavior

---

*Phase: 04.2-goal-based-logic*
*Context gathered: 2026-01-29*
