---
phase: 03.4-challenges-streak-freeze
plan: 02
subsystem: gamification
tags: [weekly-challenge, flutter, localization, achievements, bonus-points]

# Dependency graph
requires:
  - phase: 03.4-01
    provides: StorageService weekly challenge methods, achievement popup infrastructure
provides:
  - WeeklyChallengeCard widget for statistics screen
  - Localization keys for weekly challenge UI (IT/EN)
  - Challenge completion detection and bonus award flow
affects: [achievements-screen, profile-screen]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - Weekly challenge card with FrostCard glass-morphism
    - Challenge completion check with storage flag deduplication
    - AchievementPopup overlay in Stack
    - Timer-based popup auto-cleanup

key-files:
  created:
    - push_up_5050/lib/widgets/statistics/weekly_challenge_card.dart
  modified:
    - push_up_5050/lib/screens/statistics/statistics_screen.dart
    - push_up_5050/lib/l10n/app_en.arb
    - push_up_5050/lib/l10n/app_it.arb

key-decisions:
  - "Weekly challenge target = daily goal x 7 (harder than weekly goal x 5)"
  - "Challenge completion checked once per session via _hasCheckedCompletion flag"
  - "200 bonus points awarded immediately on completion"
  - "AchievementPopup auto-dismisses after 4s, cleared from state after 4.5s"

patterns-established:
  - "Challenge card pattern: FrostCard with progress bar, trophy icon, completion badge"
  - "Completion check pattern: flag-based deduplication, storage verification, popup trigger"

# Metrics
duration: 15min
completed: 2026-01-26
---

# Phase 03.4 Plan 02: Weekly Challenge Card Summary

**Weekly challenge display widget with trophy icon, progress bar (daily goal x 7 target), completion badge, and bonus award popup**

## Performance

- **Duration:** 15 min
- **Started:** 2026-01-26T10:38:18Z
- **Completed:** 2026-01-26T10:53:44Z
- **Tasks:** 4
- **Files modified:** 4

## Accomplishments

- WeeklyChallengeCard widget created with glass-morphism design
- Localization added for 5 new keys in both Italian and English
- Card integrated into StatisticsScreen below WeeklyChartCard
- Challenge completion check wired to trigger 200-point bonus and trophy popup

## Task Commits

Each task was committed atomically:

1. **Task 1: Add localization keys for weekly challenge** - `14af705` (feat)
2. **Task 2: Create WeeklyChallengeCard widget** - `e01f1e2` (feat)
3. **Task 3: Integrate WeeklyChallengeCard into StatisticsScreen** - `a41ef96` (feat)
4. **Task 4: Wire challenge completion check to trigger bonus award** - `64b9c81` (feat)

**Plan metadata:** N/A (docs created separately)

## Files Created/Modified

### Created

- `push_up_5050/lib/widgets/statistics/weekly_challenge_card.dart` - Weekly challenge card widget with trophy icon, progress bar, completion badge, and bonus text

### Modified

- `push_up_5050/lib/screens/statistics/statistics_screen.dart` - Added WeeklyChallengeCard integration, challenge completion check, and popup overlay
- `push_up_5050/lib/l10n/app_en.arb` - Added 5 localization keys for weekly challenge
- `push_up_5050/lib/l10n/app_it.arb` - Added 5 localization keys for weekly challenge

## Decisions Made

- Weekly challenge target uses daily goal x 7 (harder than weekly goal x 5) to encourage full-week consistency
- Completion check runs once per session via `_hasCheckedCompletion` flag to prevent duplicate popups
- Storage flag `hasWeeklyChallengeBeenCompleted()` prevents duplicate bonus awards for the same week
- AchievementPopup displays with temporary Achievement object, cleared after 4.5s via Timer
- Progress bar color changes from orange (#FF7A18) to green (#4CAF50) when completed

## Deviations from Plan

None - plan executed exactly as written.

## Authentication Gates

None - no external authentication required for this phase.

## Issues Encountered

None - implementation proceeded smoothly without issues.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

- Weekly challenge infrastructure complete
- StorageService methods already exist from 03.4-01
- Ready for 03.4-03: Streak Freeze implementation

**Blockers/Concerns:** None.

---
*Phase: 03.4-challenges-streak-freeze*
*Plan: 02*
*Completed: 2026-01-26*
