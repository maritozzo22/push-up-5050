---
phase: 03.1-personalized-onboarding
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - push_up_5050/lib/screens/onboarding/onboarding_data.dart
  - push_up_5050/lib/screens/onboarding/widgets/activity_level_selection.dart
  - push_up_5050/lib/screens/onboarding/widgets/capacity_slider.dart
  - push_up_5050/lib/l10n/app_en.arb
  - push_up_5050/lib/l10n/app_it.arb
autonomous: true

must_haves:
  truths:
    - "User can select activity level from 4 card options (Sedentary, Lightly Active, Active, Very Active)"
    - "User can adjust max capacity using slider with preset values (5, 10, 20, 30, 40, 50)"
    - "Each card has appropriate icon and visual feedback for selected state"
    - "All new localization keys are added for both EN and IT"
  artifacts:
    - path: "push_up_5050/lib/screens/onboarding/onboarding_data.dart"
      provides: "OnboardingData model and ActivityLevel enum"
      min_lines: 20
    - path: "push_up_5050/lib/screens/onboarding/widgets/activity_level_selection.dart"
      provides: "Activity level card selection widget"
      min_lines: 80
    - path: "push_up_5050/lib/screens/onboarding/widgets/capacity_slider.dart"
      provides: "Max capacity slider widget with discrete preset values"
      min_lines: 60
    - path: "push_up_5050/lib/l10n/app_en.arb"
      contains: "onboardingActivityTitle, onboardingSedentary, onboardingLightlyActive, onboardingActive, onboardingVeryActive, onboardingCapacityTitle"
  key_links:
    - from: "activity_level_selection.dart"
      to: "onboarding_data.dart"
      via: "import and ActivityLevel enum usage"
      pattern: "import.*onboarding_data"
    - from: "capacity_slider.dart"
      to: "onboarding_data.dart"
      via: "import and callback pattern"
      pattern: "ValueChanged<int>"
---

<objective>
Create data model and first two onboarding screen widgets

This plan establishes the foundation for the personalized onboarding flow by:
1. Creating the OnboardingData model to collect user responses
2. Building the activity level selection widget (Screen 1)
3. Building the max capacity slider widget (Screen 2)
4. Adding necessary localization keys

Purpose: Define the data structure and UI components for collecting user fitness data

Output: OnboardingData model, ActivityLevelSelection widget, CapacitySlider widget, updated i18n files
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03.1-personalized-onboarding/03.1-CONTEXT.md
@.planning/phases/03.1-personalized-onboarding/03.1-RESEARCH.md

@push_up_5050/lib/screens/onboarding/onboarding_screen.dart
@push_up_5050/lib/repositories/storage_service.dart
@push_up_5050/lib/providers/active_workout_provider.dart
@push_up_5050/lib/widgets/design_system/frost_card.dart
@push_up_5050/lib/screens/series_selection/series_selection_screen.dart
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create OnboardingData model with ActivityLevel enum</name>
  <files>push_up_5050/lib/screens/onboarding/onboarding_data.dart</files>
  <action>
Create new file `push_up_5050/lib/screens/onboarding/onboarding_data.dart` with:

1. **ActivityLevel enum** with 4 values:
   - `sedentary` (user does little to no exercise)
   - `lightlyActive` (user exercises 1-3 days/week)
   - `active` (user exercises 3-5 days/week)
   - `veryActive` (user exercises 6-7 days/week)

2. **OnboardingData class** with 4 fields:
   - `activityLevel: ActivityLevel` (default: ActivityLevel.lightlyActive)
   - `maxCapacity: int` (default: 20)
   - `frequencyDays: int` (default: 5)
   - `dailyGoal: int` (default: 50)

3. **Helper methods** (optional but helpful):
   - `startingSeries: int` getter that calculates starting series based on maxCapacity:
     - maxCapacity <= 10: return 1
     - maxCapacity <= 20: return 2
     - maxCapacity <= 30: return 5
     - maxCapacity > 30: return 10
   - `recoveryTime: int` getter that calculates recovery time based on activityLevel:
     - sedentary: 60 seconds
     - lightlyActive: 45 seconds
     - active/veryActive: 30 seconds

4. **copyWith method** for immutability pattern

Follow Flutter/Dart conventions. Use `@immutable` annotation if the class shouldn't change.

DO NOT add any storage logic here - this is a pure data model.
  </action>
  <verify>
File exists at `push_up_5050/lib/screens/onboarding/onboarding_data.dart` with:
- ActivityLevel enum with 4 values
- OnboardingData class with 4 fields and defaults
- startingSeries getter with correct logic
- recoveryTime getter with correct logic
  </verify>
  <done>
OnboardingData model compiles without errors, all fields have appropriate defaults, and calculation logic is correct.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ActivityLevelSelection widget (Screen 1)</name>
  <files>push_up_5050/lib/screens/onboarding/widgets/activity_level_selection.dart</files>
  <action>
Create new file `push_up_5050/lib/screens/onboarding/widgets/activity_level_selection.dart` with:

1. **StatelessWidget** named `ActivityLevelSelection`

2. **Constructor parameters:**
   - `selectedLevel: ActivityLevel` (current selection)
   - `onChanged: ValueChanged<ActivityLevel>` (callback when user selects)

3. **UI Layout:**
   - Title text (from i18n: `onboardingActivityLevel`)
   - Subtitle/description text (from i18n: `onboardingActivityLevelDesc`)
   - 4 vertically stacked cards, one for each activity level
   - Each card shows:
     - Icon (Material Icons):
       - Sedentary: `event_seat` or `chair`
       - Lightly Active: `directions_walk`
       - Active: `directions_run`
       - Very Active: `fitness_center`
     - Title text (from i18n)
     - Description text (from i18n)

4. **Card Styling:**
   - Use FrostedCard/glass effect pattern from existing codebase
   - Selected state: Orange gradient background (Color(0xFFFFB347) to Color(0xFFFF5F1F))
   - Unselected: Semi-transparent dark background (Color(0xFF1B1E24).withOpacity(0.55))
   - Border: white with 0.10 opacity for unselected, transparent for selected
   - Smooth animation when selection changes (AnimatedContainer with 200ms duration)

5. **Interactivity:**
   - GestureDetector on each card
   - Calls `onChanged` with selected ActivityLevel

Reference the existing `_FeatureItem` widget in `onboarding_screen.dart` for card styling patterns.

DO NOT include PageView or navigation logic - this is just the content widget.
  </action>
  <verify>
File exists at `push_up_5050/lib/screens/onboarding/widgets/activity_level_selection.dart` with:
- ActivityLevelSelection StatelessWidget
- 4 cards with correct icons
- Selected state visual feedback (orange gradient)
- onChanged callback invoked on tap
- AnimatedContainer for smooth transitions
  </verify>
  <done>
ActivityLevelSelection widget renders 4 selectable cards, shows visual feedback for selected state, and invokes callback correctly.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create CapacitySlider widget (Screen 2)</name>
  <files>push_up_5050/lib/screens/onboarding/widgets/capacity_slider.dart</files>
  <action>
Create new file `push_up_5050/lib/screens/onboarding/widgets/capacity_slider.dart` with:

1. **StatelessWidget** named `CapacitySlider`

2. **Constructor parameters:**
   - `value: int` (currently selected capacity)
   - `onChanged: ValueChanged<int>` (callback when slider moves)

3. **Slider Configuration:**
   - Preset values: [5, 10, 20, 30, 40, 50]
   - Map slider position (0-5) to preset values
   - Use Flutter Slider widget with `divisions: 5` for discrete steps

4. **UI Layout:**
   - Large value display (48px, Bold font) showing current capacity
   - "max push-ups" label below value
   - Slider below label
   - Gradient track: Color(0xFFFFB347) for active, white with 0.20 opacity for inactive
   - Thumb: Color(0xFFFFB347) with 8px radius overlay

5. **Helper Text:**
   - Text below slider: "What's the most push-ups you can do in one set?" (from i18n)
   - Smaller gray text (60% opacity)

Reference the existing slider pattern in `series_selection_screen.dart` for styling.

DO NOT include long-press acceleration - the preset values make this unnecessary.
  </action>
  <verify>
File exists at `push_up_5050/lib/screens/onboarding/widgets/capacity_slider.dart` with:
- CapacitySlider StatelessWidget
- Slider with 6 discrete positions mapped to preset values
- Large value display
- Correct styling (orange active track, white inactive)
  </verify>
  <done>
CapacitySlider widget displays current capacity, allows selection from preset values, and invokes callback on change.
  </done>
</task>

<task type="auto">
  <name>Task 4: Add i18n keys for onboarding screens 1-2</name>
  <files>push_up_5050/lib/l10n/app_en.arb, push_up_5050/lib/l10n/app_it.arb</files>
  <action>
Add the following keys to both `app_en.arb` and `app_it.arb`:

**English (app_en.arb):**
```json
"onboardingActivityLevel": "How active are you?",
"onboardingActivityLevelDesc": "This helps us personalize your workout plan",
"onboardingSedentary": "Sedentary",
"onboardingSedentaryDesc": "Little to no exercise",
"onboardingLightlyActive": "Lightly Active",
"onboardingLightlyActiveDesc": "Exercise 1-3 days per week",
"onboardingActive": "Active",
"onboardingActiveDesc": "Exercise 3-5 days per week",
"onboardingVeryActive": "Very Active",
"onboardingVeryActiveDesc": "Exercise 6-7 days per week",
"onboardingCapacityTitle": "Max Push-Ups",
"onboardingCapacityQuestion": "What's the most push-ups you can do in one set?",
"onboardingMaxPushups": "max push-ups"
```

**Italian (app_it.arb):**
```json
"onboardingActivityLevel": "Quanto sei attivo?",
"onboardingActivityLevelDesc": "Questo ci aiuta a personalizzare il tuo piano",
"onboardingSedentary": "Sedentario",
"onboardingSedentaryDesc": "Poca o nessuna attività fisica",
"onboardingLightlyActive": "Leggermente Attivo",
"onboardingLightlyActiveDesc": "Attività fisica 1-3 giorni a settimana",
"onboardingActive": "Attivo",
"onboardingActiveDesc": "Attività fisica 3-5 giorni a settimana",
"onboardingVeryActive": "Molto Attivo",
"onboardingVeryActiveDesc": "Attività fisica 6-7 giorni a settimana",
"onboardingCapacityTitle": "Flessioni Massime",
"onboardingCapacityQuestion": "Qual è il massimo numero di flessioni che riesci a fare in una sola serie?",
"onboardingMaxPushups": "flessioni massime"
```

Run `flutter pub get` after modifying arb files to regenerate AppLocalizations.

Place new keys alphabetically in the file to maintain organization.
  </action>
  <verify>
Both arb files contain all new keys with correct translations.
Run `flutter analyze` - no errors related to missing localizations.
  </verify>
  <done>
All i18n keys added to both EN and IT, AppLocalizations regenerated successfully.
  </done>
</task>

</tasks>

<verification>
1. flutter analyze passes with no errors
2. All new files compile without syntax errors
3. i18n keys are present in both languages
4. OnboardingData model has correct calculation logic
5. Widgets follow existing design patterns (glass effect, orange accent)
</verification>

<success_criteria>
- OnboardingData model exists with ActivityLevel enum and calculation getters
- ActivityLevelSelection widget renders 4 selectable cards with icons
- CapacitySlider widget allows selection from preset values [5, 10, 20, 30, 40, 50]
- All i18n keys added for EN and IT
- Code follows existing patterns from OnboardingScreen and SeriesSelectionScreen
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-personalized-onboarding/03.1-01-SUMMARY.md`
</output>
