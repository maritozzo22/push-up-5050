# Requirements Archive: v2.5 Engagement & Retention

**Archived:** 2026-01-27
**Status:** ✅ SHIPPED

This is the archived requirements specification for v2.5. Engagement & Retention.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## Requirements by Category

### ONBOARDING (Personalized) - 4 requirements

**ONBD-01: User completes 4-screen onboarding flow** ✅
- [x] User completes activity level selection (beginner, intermediate, advanced)
- [x] User completes capacity assessment (max push-ups in one set)
- [x] User completes workout frequency preference (days per week)
- [x] User completes daily goal target selection
- [x] Flow is mandatory on first launch (per anti-cheat requirements)

**ONBD-02: System calculates personalized recommendations** ✅
- [x] Starting series recommended based on capacity (1, 2, 5, or 10)
- [x] Daily goal calculated from capacity and frequency
- [x] Recovery time recommended based on activity level (beginner: 60s, intermediate: 45s, advanced: 30s)
- [x] Recommendations shown to user before saving

**ONBD-03: User can edit all recommendations in settings** ✅
- [x] Settings screen exposes starting series configuration
- [x] Settings screen exposes daily goal target
- [x] Settings screen exposes recovery time configuration
- Note: Anti-cheat restrictions apply post-onboarding

**ONBD-04: Onboarding integrates with existing GoalsProvider persistence** ✅
- [x] Personalized recommendations saved via StorageService
- [x] Custom values from onboarding persist across app sessions
- [x] Defaults used if onboarding skipped or not completed

### POINTS SYSTEM (Enhanced) - 5 requirements

**POINTS-01: Points calculated with new aggressive formula** ✅
- [x] Formula: Base × (RepMult + SeriesMult) × StreakMult
- [x] Base = 10 points per series
- [x] Total points awarded immediately upon series completion
- [x] Formula applied consistently across all workout sessions

**POINTS-02: Rep multiplier = push-ups × 0.3** ✅
- [x] RepMult = push-ups in series × 0.3
- [x] Example: Series 5 (5 push-ups) = 5 × 0.3 = 1.5
- [x] Example: Series 10 (10 push-ups) = 10 × 0.3 = 3.0

**POINTS-03: Series multiplier = series × 0.8** ✅
- [x] SeriesMult = series number × 0.8
- [x] Example: Series 5 = 5 × 0.8 = 4.0
- [x] Example: Series 10 = 10 × 0.8 = 8.0

**POINTS-04: Points persisted to DailyRecord** ✅
- [x] DailyRecord.pointsEarned stores points for each day
- [x] DailyRecord.multiplier stores the effective multiplier applied
- [x] Points update immediately after each series completes

**POINTS-05: Total points persisted to UserStats** ✅
- [x] UserStats.totalPoints accumulates all daily points
- [x] Total points displayed in statistics screen
- [x] Total points used for level calculations

### WEEKLY GOALS - 5 requirements

**WEEKLY-01: Weekly target calculated as daily goal × 5** ✅
- [x] Weekly target = user's daily goal × 5 workout days
- [x] Target updates when daily goal changes
- [x] Target displayed in statistics screen

**WEEKLY-02: Sunday popup shows weekly progress percentage** ✅
- [x] Popup appears on first app launch on Sunday
- [x] Shows percentage of weekly target completed
- [x] Shows total push-ups this week vs weekly target
- [x] User can dismiss popup with "Close" button

**WEEKLY-03: User receives bonus 500 points when weekly target reached** ✅
- [x] Bonus awarded when weekly push-ups >= weekly target
- [x] Bonus points added to daily total for Sunday
- [x] Achievement notification shows bonus points awarded

**WEEKLY-04: Popup offers goal increase options when target reached** ✅
- [x] If weekly target reached, popup shows three options: maintain, +10%, +20%
- [x] If weekly target missed, popup shows decrease options: -10%, -20%, -30%
- [x] Selection updates GoalsProvider.dailyGoal immediately

**WEEKLY-05: Streak resets only if user completes 0 workouts in the week** ✅
- [x] Streak resets on Sunday ONLY if weekly push-ups = 0
- [x] Any push-ups completed during week preserve streak
- [x] Previous behavior (streak reset daily if goal not met) replaced

### CHALLENGES - 3 requirements

**CHAL-01: User can view weekly challenge** ✅
- [x] Challenge displayed in statistics screen
- [x] Challenge format: "Complete X push-ups this week"
- [x] Challenge target = daily goal × 7
- [x] Progress bar shows current progress toward challenge
- [x] Challenge resets every Sunday

**CHAL-02: User receives badge upon challenge completion** ✅
- [x] Badge notification shown when weekly challenge completed
- [x] Badge displayed in achievements screen
- [x] Badge name: "Weekly Challenge [date]"
- [x] Challenge completion awards 200 bonus points

**CHAL-03: User has 1 streak freeze per month** ✅
- [x] Streak freeze prevents streak reset for one week
- [x] Streak freeze auto-activates if weekly push-ups > 0 but < goal
- [x] Streak freeze counter resets on 1st of each month
- [x] Visual indicator shows when streak freeze is active (snowflake icon)

### NOTIFICATIONS - 4 requirements

**NOTIF-01: User receives "streak at risk" notification after 2 missed days** ✅
- [x] Notification sent if no workout completed for 2 consecutive days
- [x] Notification text localized for IT/EN
- [x] Notification sent at user's preferred workout time (default 9:00 AM)

**NOTIF-02: User receives progress notification when close to daily goal** ✅
- [x] Notification sent when daily push-ups >= daily goal - 5 (at 50%+ threshold)
- [x] Notification text localized for IT/EN
- [x] Notification sent only once per day

**NOTIF-03: Notification time personalized to user's workout patterns** ✅
- [x] System tracks when user completes workouts
- [x] Notification time set to median workout completion time (2-hour window binning)
- [x] Default to 9:00 AM if insufficient data (7-day minimum)
- [x] User can manually set notification time in settings

**NOTIF-04: User receives new challenge notification on Sunday** ✅
- [x] Notification sent at 8:00 AM on Sunday
- [x] Notification text localized for IT/EN
- [x] Opens statistics screen when tapped

### ANTI-CHEAT - 2 requirements

**ANTCHEAT-01: Daily push-up cap enforced based on user level and goal** ✅
- [x] Cap formula: daily goal × (1 + (level × 0.1))
- [x] Level 1-3: cap = daily goal × 1.5
- [x] Level 4: cap = daily goal × 2.0
- [x] Level 5+: cap = daily goal × 2.5
- [x] Push-ups beyond cap tracked but not counted toward totals

**ANTCHEAT-02: Points awarded only up to daily cap** ✅
- [x] Points calculation capped at daily push-up limit
- [x] Excess push-ups logged separately (visible to user but not rewarded)
- [x] User shown message when cap reached

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| ONBD-01 | 03.1 | ✅ Complete |
| ONBD-02 | 03.1 | ✅ Complete |
| ONBD-03 | 03.1 | ✅ Complete |
| ONBD-04 | 03.1 | ✅ Complete |
| POINTS-01 | 03.2 | ✅ Complete |
| POINTS-02 | 03.2 | ✅ Complete |
| POINTS-03 | 03.2 | ✅ Complete |
| POINTS-04 | 03.2 | ✅ Complete |
| POINTS-05 | 03.2 | ✅ Complete |
| ANTCHEAT-01 | 03.2 | ✅ Complete |
| ANTCHEAT-02 | 03.2 | ✅ Complete |
| WEEKLY-01 | 03.3 | ✅ Complete |
| WEEKLY-02 | 03.3 | ✅ Complete |
| WEEKLY-03 | 03.3 | ✅ Complete |
| WEEKLY-04 | 03.3 | ✅ Complete |
| WEEKLY-05 | 03.3 | ✅ Complete |
| CHAL-01 | 03.4 | ✅ Complete |
| CHAL-02 | 03.4 | ✅ Complete |
| CHAL-03 | 03.4 | ✅ Complete |
| NOTIF-01 | 03.5 | ✅ Complete |
| NOTIF-02 | 03.5 | ✅ Complete |
| NOTIF-03 | 03.5 | ✅ Complete |
| NOTIF-04 | 03.5 | ✅ Complete |

## Milestone Summary

**Shipped:** 22 of 22 requirements (100%)
**Adjusted:** 0 requirements
**Dropped:** 0 requirements

**Out of Scope (Deferred to Future Milestone):**
- Social sharing (Instagram templates, shareable badges, challenge links)
- Monetization (Ads, shop themes, premium features)
- Multiplayer challenges

---

*Archived: 2026-01-27 as part of v2.5 milestone completion*
